# Домашнее задание к занятию «Компоненты Kubernetes»


## 1. Расчёт необходимых ресурсов

На основе предоставленных требований:

| Компонент           | Кол-во копий | RAM (на копию) | CPU (на копию) | Общая RAM | Общий CPU |
|---------------------|--------------|----------------|----------------|-----------|-----------|
| База данных         | 3            | 4 ГБ           | 1 ядро         | 12 ГБ     | 3 ядра    |
| Кеш                 | 3            | 4 ГБ           | 1 ядро         | 12 ГБ     | 3 ядра    |
| Фронтенд            | 5            | 50 МБ          | 0.2 ядра       | 250 МБ    | 1 ядро    |
| Бекенд              | 10           | 600 МБ         | 1 ядро         | 6 ГБ      | 10 ядер   |
| **Итого:**          | —            | —              | —              | **30.25 ГБ** | **17 ядер** |

---

## 2. Определение количества worker-нод

Для обеспечения отказоустойчивости и перераспределения нагрузки при выходе одной ноды из строя предполагается использование **трёх worker-нод**. Это позволяет потерять до 33% ресурсов без деградации сервиса.

### Распределение компонентов по нодам (ориентировочно):
- 1 экземпляр БД
- 1 экземпляр кеша
- 1–2 экземпляра фронтенда
- 3–4 экземпляра бекенда

### Примерные ресурсы на одну ноду:
- **RAM:** 4 (БД) + 4 (кеш) + 0.1 (фронтенд) + 2.4 (бекенд) = **10.5 ГБ**
- **CPU:** 1 + 1 + 0.4 + 4 = **6.4 ядра**

---

## 3. Учёт запаса на отказ одной ноды

Для компенсации потери одной из трёх нод необходим **50% запас** на каждой из оставшихся двух нод:

- **RAM:** 10.5 × 1.5 = **15.75 ГБ**
- **CPU:** 6.4 × 1.5 = **9.6 ядер**

---

## 4. Резерв на служебные нужды Kubernetes

В среднем на служебные процессы рекомендуется резервировать:
- **RAM:** 10% от рабочей нагрузки
- **CPU:** ~0.5 ядра

С учётом запаса:

- **RAM:** 15.75 + 1.5 = **17.25 ГБ**
- **CPU:** 9.6 + 0.5 = **10.1 ядер**

Округляя в сторону увеличения:

- **RAM на ноду:** **18 ГБ**
- **CPU на ноду:** **10 ядер**

---

## 5. Результат

| Параметр                   | Значение                   |
|----------------------------|----------------------------|
| Количество worker-нод      | 3                          |
| Ресурсы на одну ноду       | **18 ГБ RAM**, **10 CPU**  |
| Резерв на отказ 1 ноды     | Учтён (50%)                |
| Резерв на служебные нужды  | Учтён (RAM +10%, CPU +0.5) |

---

## 6. Возможная оптимизация

Для повышения эффективности и масштабируемости можно использовать **разделение нод по ролям**:

- **Ноды для stateful-компонентов (БД, кеш):**
  - приоритет: RAM, IOPS-диски
- **Ноды для stateless-компонентов (фронтенд, бекенд):**
  - приоритет: CPU, сеть

Такой подход повышает отказоустойчивость и управляемость при масштабировании, но требует больше ресурсов и возможного усложнения инфраструктуры.

---

## Вывод

Для текущего проекта необходимо развернуть **3 worker-ноды** с параметрами:

- **18 ГБ RAM**
- **10 ядер CPU**

Это обеспечивает:
- отказоустойчивость при выходе одной ноды,
- достаточные ресурсы для всех компонентов с учётом резерва,
- основу для будущей оптимизации и масштабирования.



